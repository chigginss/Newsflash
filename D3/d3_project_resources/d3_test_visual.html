
<!DOCTYPE html>
<html>
<body>
    <head>
      <link href='style.css' rel='stylesheet'>
    </head>
    <center>
    <h1>Top Trending News</h1>
    </center>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="https://static01.nyt.com/js/util/tooltip.js"></script>
    <script>
       let data = [
                {art_title: 'test test test test test test test test', news_source: 'The New York Times', popularity: 1, bias: 'left'},
                {art_title: 'test test test', news_source: 'Politico', popularity: 11, bias: 'left'},
                {art_title: 'test test test', news_source: 'Breitbart', popularity: 5, bias: 'right'},
                {art_title: 'test test test', news_source: 'NBC News', popularity: 8, bias:' left'},
                {art_title: 'test test test', news_source: 'The Wall Street Journal', popularity: 3, bias: 'left'},
                // {art_title: 'test test test', news_source: 'Politico', popularity: 2, bias: 'left'},
       ];
       let minData = d3.min(data, (d) => 0);
       let maxData = d3.max(data, (d) => d.popularity);
       let sizeScale = d3.scaleLinear()
         .domain([minData, maxData])
         .range([80, 140]);

      let colorScale = d3.scaleOrdinal(['blue','green']);

      let xScale = d3.scaleLinear()
         .domain([minData, maxData])
         .range([0, 1000]);
       
    var svgContainer = d3.select("body")
        .append("svg")
        .attr("width", 5000)
        .attr("height", 3000);

       var groups = svgContainer.selectAll('.article-node')
                     .data(data)
                     .enter()
                     .append('g')
                     .attr("class", "article-node");

       groups.append('circle')
             .attr('r', (d) => sizeScale(d.popularity))
             .attr('cx', (d) => xScale(d.popularity))
             .attr('cy', 100)
             .style('fill', (d) => colorScale(d.art_title));
             // .selectAll(".tick text")
             // .call(wrap, x.rangeBand());

       groups.append('text')
             .attr('x', (d) => xScale(d.popularity))
             .attr('y', 100)
             .attr('text-anchor', 'middle')
             .text((d) => d.art_title);
             // .selectAll('tspan')
             // .call(wrap, 20);

      groups.append('text')
             .attr('x', (d) => xScale(d.popularity))
             .attr('y', 125)
             .attr('text-anchor', 'middle')
             .text((d) => d.news_source);

      let xAxis = d3.axisBottom(xScale);
      svgContainer.append('g').call(xAxis)
          .attr("transform", "translate(0,300)");


    //   this.circle = this.svg.selectAll("circle")
    //     .data(this.nodes, function(d) {
    //         return d.sid;
    //     });

    // this.circle.enter().append("svg:circle")
    //     .attr("r", function(d) {
    //         return 0;
    //     })
    //     .style("fill", function(d) {
    //         return that.getFillColor(d);
    //     })
    //     .style("stroke-width", 1)
    //     .attr('id', function(d) {
    //         return 'nytg-circle' + d.sid
    //     })
    //     .style("stroke", function(d) {
    //         return that.getStrokeColor(d);
    //     })
    //   .on("mouseover", function(d, i) {
    //       var el = d3.select(this)
    //       var xpos = Number(el.attr('cx'))
    //       var ypos = (el.attr('cy') - d.radius - 10)
    //       el.style("stroke", "#000").style("stroke-width", 3);
    //       d3.select("#tooltip").style('top', ypos + "px").style('left', xpos + "px").style('display', 'block')
    //           // .classed('nytg-plus', (d.changeCategory > 0))
    //           // .classed('nytg-minus', (d.changeCategory < 0));
    //       d3.select("#tooltip .nytg-name").html(that.nameFormat(d.bias))

    //       d3.select("#tooltip"+d.popularity).text(that.discretionFormat(d.popularity))
    //       d3.select("#tooltip"+d.news_source).text(d.news_source)
    //       d3.select("#tooltip"+d.bias).html("$" + that.bigFormat(d.bias))

    //       var pctchngout = that.pctFormat(d.bias)
    //       if (d.bias == "NULL") {
    //           pctchngout = "N.A."
    //       };
    //       d3.select("#tooltip").html(pctchngout)
    //   })
    //   .on("mouseout", function(d, i) {
    //       d3.select(this)
    //           .style("stroke-width", 1)
    //           .style("stroke", function(d) {
    //               return that.getStrokeColor(d);
    //           })
    //       d3.select("#tooltip").style('display', 'none')
    //   });

    // <div id="nytg-tooltip">
    //     <div id="nytg-tooltipContainer">
    //         <div class="nytg-department"></div>
    //         <div class="nytg-rule"></div>
    //         <div class="nytg-name"></div>
    //         <div class="nytg-discretion"></div>
    //         <div class="nytg-valuesContainer">
    //             <span class="nytg-value"></span>
    //             <span class="nytg-change"></span>
    //         </div>
    //         <div class="nytg-chart"></div>
    //         <div class="nytg-tail"></div>
    //     </div>
    //     </div>

      function handleMouseover(d){
        svgContainer.append('text')
           .attr('x', xScale(d.popularity))
           .attr('y', (d) => 160)
           .text("description"+d.bias)
           .attr('class', 'tooltip'+d.bias);
      }

      function handleMouseout(d){
        d3.select('.tooltip'+d.bias).remove();
      }
      
      groups.on('mouseover', handleMouseover);
      groups.on('mouseout', handleMouseout);

      function wrap(text, width) {
        text.each(function() {
          var text = d3.select(this),
              words = text.text().split(/\s+/).reverse(),
              word,
              line = [],
              lineNumber = 0,
              lineHeight = 1.1, // ems
              y = text.attr("y"),
              dy = parseFloat(text.attr("dy")),
              tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
          while (word = words.pop()) {
            line.push(word);
            tspan.text(line.join(" "));
            if (tspan.node().getComputedTextLength() > width) {
              line.pop();
              tspan.text(line.join(" "));
              line = [word];
              tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
            }
          }
        });
      }  
    </script>

</body>


</html>